<link rel="stylesheet" href="https://www.gstatic.com/dialogflow-console/fast/df-messenger/prod/v1/themes/df-messenger-default.css">
<script src="https://www.gstatic.com/dialogflow-console/fast/df-messenger/prod/v1/df-messenger.js"></script>

<button id="clear-chat">Clear Chat</button>

<df-messenger
  project-id="testaichatbot-466813"
  agent-id="f0509c13-7c76-486d-bb4f-84f8ed02211e"
  language-code="en"
  max-query-length="-1">
  <df-messenger-chat-bubble chat-title="finchat">
  </df-messenger-chat-bubble>
</df-messenger>

<style>
  df-messenger {
    z-index: 999;
    position: fixed;
    --df-messenger-font-color: #000;
    --df-messenger-font-family: Google Sans;
    --df-messenger-chat-background: #f3f6fc;
    --df-messenger-message-user-background: #d3e3fd;
    --df-messenger-message-bot-background: #fff;
    bottom: 16px;
    right: 16px;
  }

  #clear-chat {
    position: fixed;
    bottom: 100px;
    right: 380px;
    background-color: #d9534f;
    color: white;
    border: none;
    padding: 10px 14px;
    border-radius: 4px;
    font-weight: bold;
    cursor: pointer;
    z-index: 1000;
  }
</style>

<script>
  document.getElementById("clear-chat").addEventListener("click", function () {
    const dfMessenger = document.querySelector("df-messenger");

    // Step 1: Clear all messages
    try {
      const iframe = dfMessenger.shadowRoot.querySelector("iframe");
      const innerDoc = iframe.contentDocument || iframe.contentWindow.document;
      const messagePane = innerDoc.querySelector("df-chat-messages");
      if (messagePane) {
        messagePane.innerHTML = "";
      }
    } catch (e) {
      console.warn("Unable to clear messages:", e);
    }

    // Step 2: Reset session
    const newSessionId = "session-" + Math.floor(Math.random() * 1000000);
    dfMessenger.setAttribute("session-id", newSessionId);
  });
</script>
